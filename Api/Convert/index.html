



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Text-Fabric is a Python3 package for Text plus Annotations. It provides a data model, a text file format, a binary format, an API, and apps for (ancient) text plus (linguistic) annotations.">
      
      
        <link rel="canonical" href="https://annotation.github.io/text-fabric/Api/Convert/">
      
      
        <meta name="author" content="Dirk Roorda">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/icon/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>Convert (MQL) - Text-Fabric</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#convert" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://annotation.github.io/text-fabric/" title="Text-Fabric" class="md-header-nav__button md-logo">
          
            <img src="../../images/tf-small.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Text-Fabric
              </span>
              <span class="md-header-nav__topic">
                Convert (MQL)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/annotation/text-fabric/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://annotation.github.io/text-fabric/" title="Text-Fabric" class="md-nav__button md-logo">
      
        <img src="../../images/tf-small.png" width="48" height="48">
      
    </a>
    Text-Fabric
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/annotation/text-fabric/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../About/Install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../About/Corpora/" title="Corpora" class="md-nav__link">
      Corpora
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../About/Faq/" title="Faq" class="md-nav__link">
      Faq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../About/News/" title="News" class="md-nav__link">
      News
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../About/Older/" title="Older" class="md-nav__link">
      Older
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Use
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Use
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Use/Use/" title="Use" class="md-nav__link">
      Use
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Use/Browser/" title="Browser" class="md-nav__link">
      Browser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Use/Search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Use/Use7/" title="v7-Guide" class="md-nav__link">
      v7-Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Api
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Api
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../App/" title="Apps" class="md-nav__link">
      Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data/" title="Data" class="md-nav__link">
      Data
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" checked>
    
    <label class="md-nav__link" for="nav-4-3">
      Core
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Fabric/" title="TF" class="md-nav__link">
      TF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Features/" title="F - Features" class="md-nav__link">
      F - Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nodes/" title="N - Nodes" class="md-nav__link">
      N - Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Locality/" title="L - Locality" class="md-nav__link">
      L - Locality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Text/" title="T - Text" class="md-nav__link">
      T - Text
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Search/" title="S - Search" class="md-nav__link">
      S - Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Computed/" title="C - Computed" class="md-nav__link">
      C - Computed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Misc/" title="Miscellaneous" class="md-nav__link">
      Miscellaneous
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Convert (MQL)
      </label>
    
    <a href="./" title="Convert (MQL)" class="md-nav__link md-nav__link--active">
      Convert (MQL)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#token-stream" title="Token Stream" class="md-nav__link">
    Token Stream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mql" title="MQL" class="md-nav__link">
    MQL
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lib/" title="Lib" class="md-nav__link">
      Lib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Helpers/" title="Helpers" class="md-nav__link">
      Helpers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Writing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Writing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Writing/Arabic.html" title="Arabic" class="md-nav__link">
      Arabic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Writing/Hebrew.html" title="Hebrew" class="md-nav__link">
      Hebrew
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Writing/Syriac.html" title="Syriac" class="md-nav__link">
      Syriac
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Writing/Transcription/" title="Transcription" class="md-nav__link">
      Transcription
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Model
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Model
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Model/Data-Model/" title="Data" class="md-nav__link">
      Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Model/File-formats/" title="Format" class="md-nav__link">
      Format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Model/Optimizations/" title="Tweaks" class="md-nav__link">
      Tweaks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Model/Search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Create
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Create
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Create/CreateTF/" title="Make TF" class="md-nav__link">
      Make TF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Create/ExampleText/" title="Example data" class="md-nav__link">
      Example data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Server/Kernel/" title="Kernel" class="md-nav__link">
      Kernel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Server/Web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Server/Common/" title="Common" class="md-nav__link">
      Common
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/Tests/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/Stats/" title="Stats (overall)" class="md-nav__link">
      Stats (overall)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsToplevel/" title="Stats (TF-toplevel)" class="md-nav__link">
      Stats (TF-toplevel)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsCore/" title="Stats (TF-core)" class="md-nav__link">
      Stats (TF-core)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsSearch/" title="Stats (TF-search)" class="md-nav__link">
      Stats (TF-search)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsConvert/" title="Stats (TF-convert)" class="md-nav__link">
      Stats (TF-convert)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsWriting/" title="Stats (TF-writing)" class="md-nav__link">
      Stats (TF-writing)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsServer/" title="Stats (TF-server)" class="md-nav__link">
      Stats (TF-server)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsApplib/" title="Stats (TF-app support)" class="md-nav__link">
      Stats (TF-app support)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsApps/" title="Stats (TF-apps)" class="md-nav__link">
      Stats (TF-apps)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Code/StatsTest/" title="Stats (Tests)" class="md-nav__link">
      Stats (Tests)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Implementation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Implementation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Apps/" title="Apps" class="md-nav__link">
      Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Data/" title="Data" class="md-nav__link">
      Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Display/" title="Display" class="md-nav__link">
      Display
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Highlight/" title="Highlight" class="md-nav__link">
      Highlight
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Links/" title="Links" class="md-nav__link">
      Links
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Tables/" title="Tables" class="md-nav__link">
      Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Implementation/Helpers/" title="Helpers" class="md-nav__link">
      Helpers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#token-stream" title="Token Stream" class="md-nav__link">
    Token Stream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mql" title="MQL" class="md-nav__link">
    MQL
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/annotation/text-fabric/edit/master/docs/Api/Convert.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="convert">Convert<a class="headerlink" href="#convert" title="Permanent link">&para;</a></h1>
<h2 id="token-stream">Token Stream<a class="headerlink" href="#token-stream" title="Permanent link">&para;</a></h2>
<details class="info"><summary>Data conversion to TF</summary><p>You can convert a dataset to TF by writing a token generator for it.</p>
<p>That is a function that delivers a stream of tokens when reading the data.
Text-Fabric can consume that stream and build a valid Text-Fabric dataset out of it.
Many checks will be performed.</p>
</details>
<details class="abstract"><summary>Token(TF)</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">tf.fabric</span> <span class="kn">import</span> <span class="n">Fabric</span>
<span class="kn">from</span> <span class="nn">tf.convert.walker</span> <span class="kn">import</span> <span class="n">CV</span>

<span class="n">TF</span> <span class="o">=</span> <span class="n">Fabric</span><span class="p">(</span><span class="n">locations</span><span class="o">=</span><span class="n">OUT_DIR</span><span class="p">)</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">CV</span><span class="p">(</span><span class="n">TF</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">director</span><span class="p">(</span><span class="n">cv</span><span class="p">):</span>
  <span class="c1"># your code to unwrap your source data and trigger </span>
  <span class="c1"># the generation of TF nodes, edges and features</span>

<span class="n">slotType</span> <span class="o">=</span> <span class="s1">&#39;word&#39;</span>  <span class="c1"># or whatever you choose</span>
<span class="n">otext</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># dictionary of config data for sections and text formats</span>
    <span class="o">...</span>
<span class="p">}</span>
<span class="n">generic</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># dictionary of metadata meant for all features</span>
    <span class="o">...</span>
<span class="p">}</span>
<span class="n">intFeatures</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># set of integer valued feature names</span>
    <span class="o">...</span>
<span class="p">}</span>
<span class="n">featureMeta</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># per feature dicts with metadata</span>
   <span class="o">...</span>
<span class="p">}</span>

<span class="n">good</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span>
    <span class="n">director</span><span class="p">,</span>
    <span class="n">slotType</span><span class="p">,</span>
    <span class="n">otext</span><span class="o">=</span><span class="n">otext</span><span class="p">,</span>
    <span class="n">generic</span><span class="o">=</span><span class="n">generic</span><span class="p">,</span>
    <span class="n">intFeatures</span><span class="o">=</span><span class="n">intFeatures</span><span class="p">,</span>
    <span class="n">featureMeta</span><span class="o">=</span><span class="n">featureMeta</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">good</span><span class="p">:</span>
  <span class="o">...</span> <span class="n">load</span> <span class="n">the</span> <span class="n">new</span> <span class="n">TF</span> <span class="n">data</span> <span class="o">...</span>
</pre></div>
</td></tr></table>

<details class="info" open="open"><summary>Description</summary><p><code>cv.walk</code> takes your <code>director</code> function which should unravel the source.
You have to program the <code>director</code>, which takes one argument: <code>cv</code>.
From the <code>cv</code> you can use a few standard actions that instruct Text-Fabric
to build a graph.</p>
<p>This function will check whether the metadata makes sense and is minimally
complete.</p>
<p>After the creation of the feature data, some extra checks will be performed
to see whether the metadata matches the data and vice versa.</p>
</details>
<details class="hint"><summary>Destination directory</summary><p>The new feature data will be written to the output directory of the
underlying TF object.
In fact, the rules are exactly the same as for <code>TF.save()</code>.</p>
</details>
<details class="info"><summary>director</summary><p>An ordinary function that takes one argument, the <code>cv</code> object, and
should not deliver anything.</p>
<p>Writing this function is the main job to do when you want to convert a data source
to TF.</p>
<p>When you walk through the input data source, you'll encounter things
that have to become slots, non-slot nodes, edges and features in the new data set.</p>
<p>You issue these things by means of an <em>method</em> from <code>cv</code>, such as
<code>cv.slot()</code> or <code>cv.node(nodeType)</code>.</p>
<p>When your action creates slots or non slot nodes,
Text-Fabric will return you a reference to that node,
that you can use later for more actions related to that node.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">curPara</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;para&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>There is always a current node.
If an action must refer to a node, and no node is passed,
it will use the current node.</p>
<p>To add features to nodes, use a <code>cv.feature()</code> action.
It will apply to the last node added, or you can pass it a node as argument.</p>
<p>To add features to edges, issue a <code>cv.edge()</code> action.
It will require two node arguments: the <em>from</em> node and the <em>to</em> node.</p>
<p>There is always a set of current <em>embedder nodes</em>.
When you create a slot node</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">curWord</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">slot</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>then TF will link all current embedder nodes to the resulting slot.</p>
<p>There are actions to add nodes to the set of embedder nodes,
to remove them from it,
and to add them again. </p>
<details class="explanation" open="open"><summary><code>cv</code> action methods</summary><p>The <code>cv</code> class contains methods
that are responsible for particular <em>actions</em> that steer the graph building.
You can pass them additional arguments.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">slot</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">nodeType</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
<span class="n">cv</span><span class="o">.</span><span class="n">terminate</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">resume</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">feature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">feature</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="n">cv</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">mt</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<details class="explanation"><summary>Remarks</summary><p>To make a <strong>slot</strong> node, use <code>cv.slot</code>.</p>
<p>No further information is needed.
Remember that you can add features to the node by later <code>cv.feature</code>
calls.</p>
<p>To make a <strong>non-slot node</strong>, use <code>cv.node</code>.</p>
<p>You have to pass its <em>node type</em>, i.e. a string.
Think of <code>sentence</code>, <code>paragraph</code>, <code>phrase</code>.
Non slot nodes will be automatically added to the set of embedders.</p>
<p>To <strong>terminate</strong> a node, use <code>cv.terminate</code>.</p>
<p>The node will be removed from the set of current embedders.
You can either terminate the current node, or a specific node <em>m</em>.
This <em>m</em> must be the result of a previous <code>cv</code> action.</p>
<p>To <strong>resume</strong> a node, use <code>cv.resume</code>.</p>
<p>If you resume a non-slot node, you add it again to the set of embedders.
No new node will be created.</p>
<p>If you resume a slot node, it will be added to the set of current embedders.
No new slot will be created.</p>
<p>To add <strong>node features</strong>, use <code>cv.feature</code>.</p>
<p>The features are passed as a list of keyword arguments.</p>
<p>These features are added to the current node, or, if you pass a 
node <em>m</em>, to <em>m</em>, which must have been obtained by an earlier
<code>cv</code> action.</p>
<p>To add <strong>edge features</strong>, use <code>cv.edge</code>.</p>
<p>You need to pass two nodes, <em>mFrom</em> and <em>mTo</em>.
Together these specify an edge, and the features will be applied
to this edge.</p>
<p>The features are passed as a list of keyword arguments.</p>
</details>
</details>
<details class="hint" open="open"><summary>Example</summary><p>See the example for
<a href="https://github.com/Nino-cunei/oldbabylonian/blob/master/programs/tfFromATF.py">Old Babylonian</a></p>
</details>
</details>
<details class="info"><summary>slotType</summary><p>The node type that acts as the type of the slots in the data set.</p>
</details>
<details class="info"><summary>oText</summary><p>The configuration information to be stored in the <code>otext</code> feature:
<em> section types 
</em> section features 
* text formats</p>
<p>Must be a dict.</p>
</details>
<details class="info"><summary>generic</summary><p>Metadata that will be written into the header of all generated TF features.</p>
<p>Must be a dict.</p>
</details>
<details class="info"><summary>intFeatures</summary><p>The set of features that have integer values only.</p>
<p>Must be an iterable.</p>
</details>
<details class="info"><summary>featureMeta</summary><p>For each node or edge feature descriptive metadata can be supplied.</p>
<p>Must be a dict of dicts.</p>
</details>
</details>
<h2 id="mql">MQL<a class="headerlink" href="#mql" title="Permanent link">&para;</a></h2>
<details class="info"><summary>Data interchange with MQL</summary><p>You can interchange with
<a href="https://emdros.org">MQL data</a>.
Text-Fabric can read and write MQL dumps. An
MQL dump is a text file, like an SQL dump. It contains the instructions to
create and fill a complete database.</p>
</details>
<details class="abstract"><summary>TF.exportMQL()</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">TF</span><span class="o">.</span><span class="n">exportMQL</span><span class="p">(</span><span class="n">dbName</span><span class="p">,</span> <span class="n">dirName</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<details class="info" open="open"><summary>Description</summary><p>Exports the complete TF dataset into single MQL database.</p>
</details>
<details class="info"><summary>dirName, dbName</summary><p>The exported file will be written to <code>dirName/dbName.mql</code>. If <code>dirName</code> starts
with <code>~</code>, the <code>~</code> will be expanded to your home directory. Likewise, <code>..</code> will
be expanded to the parent of the current directory, and <code>.</code> to the current
directory, both only at the start of <code>dirName</code>.</p>
</details>
<details class="explanation"><summary>Correspondence TF and MQL</summary><p>The resulting MQL database has the following properties with respect to the
Text-Fabric dataset it comes from:</p>
<ul>
<li>the TF <em>slots</em> correspond exactly with the MQL <em>monads</em> and have the same
    numbers; provided the monad numbers in the MQL dump are consecutive. In MQL
    this is not obligatory. Even if there gaps in the monads sequence, we will
    fill the holes during conversion, so the slots are tightly consecutive;</li>
<li>the TF <em>nodes</em> correspond exactly with the MQL <em>objects</em> and have the same
    numbers</li>
</ul>
</details>
<details class="note"><summary>Node features in MQL</summary><p>The values of TF features are of two types, <code>int</code> and <code>str</code>, and they translate
to corresponding MQL types <code>integer</code> and <code>string</code>. The actual values do not
undergo any transformation.</p>
<p>That means that in MQL queries, you use quotes if the feature is a string feature.
Only if the feature is a number feature, you may omit the quotes:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[word sp=&#39;verb&#39;]
[verse chapter=1 and verse=1]
</pre></div>
</td></tr></table>

</details>
<details class="note"><summary>Enumeration types</summary><p>It is attractive to use eumeration types for the values of a feature, whereever
possible, because then you can query those features in MQL with <code>IN</code> and without
quotes:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[chapter book IN (Genesis, Exodus)]
</pre></div>
</td></tr></table>

<p>We will generate enumerations for eligible features.</p>
<p>Integer values can already be queried like this, even if they are not part of an
enumeration. So we restrict ourselves to node features with string values. We
put the following extra restrictions:</p>
<ul>
<li>the number of distinct values is less than 1000</li>
<li>all values must be legal C names, in practice: starting with a letter,
    followed by letters, digits, or <code>_</code>. The letters can only be plain ASCII
    letters, uppercase and lowercase.</li>
</ul>
<p>Features that comply with these restrictions will get an enumeration type.
Currently, we provide no ways to configure this in more detail.</p>
<details class="note"><summary>Merged enumeration types</summary><p>Instead of creating separate enumeration types for individual features,
we collect all enumerated values for all those features into one
big enumeration type.</p>
<p>The reason is that MQL considers equal values in different types as
distinct values. If we had separate types, we could never compare
values for different features.</p>
</details>
</details>
<details class="caution"><summary>Values of edge features are ignored</summary><p>There is no place for edge values in
MQL. There is only one concept of feature in MQL: object features,
which are node features.
But TF edges without values can be seen as node features: nodes are
mapped onto sets of nodes to which the edges go. And that notion is supported by
MQL:
edge features are translated into MQL features of type <code>LIST OF id_d</code>,
i.e. lists of object identifiers.</p>
</details>
<details class="caution"><summary>Legal names in MQL</summary><p>MQL names for databases, object types and features must be valid C identifiers
(yes, the computer language C). The requirements are:</p>
<ul>
<li>start with a letter (ASCII, upper-case or lower-case)</li>
<li>follow by any sequence of ASCII upper/lower-case letters or digits or
    underscores (<code>_</code>)</li>
<li>avoid being a reserved word in the C language</li>
</ul>
<p>So, we have to change names coming from TF if they are invalid in MQL. We do
that by replacing illegal characters by <code>_</code>, and, if the result does not start
with a letter, we prepend an <code>x</code>. We do not check whether the name is a reserved
C word.</p>
<p>With these provisos:</p>
<ul>
<li>the given <code>dbName</code> correspond to the MQL <em>database name</em></li>
<li>the TF <em>otypes</em> correspond to the MQL <em>objects</em></li>
<li>the TF <em>features</em> correspond to the MQL <em>features</em></li>
</ul>
</details>
<details class="hint"><summary>File size</summary><p>The MQL export is usually quite massive (500 MB for the Hebrew Bible).
It can be compressed greatly, especially by the program <code>bzip2</code>.</p>
</details>
<details class="caution"><summary>Exisiting database</summary><p>If you try to import an MQL file in Emdros, and there exists already a file or
directory with the same name as the MQL database, your import will fail
spectacularly. So do not do that. A good way to prevent it is:</p>
<ul>
<li>export the MQL to outside your <code>text-fabric-data</code> directory, e.g. to
    <code>~/Downloads</code>;</li>
<li>before importing the MQL file, delete the previous copy;</li>
</ul>
<details class="example"><summary>Delete existing copy</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">cd</span> ~/Downloads
rm dataset <span class="p">;</span> mql -b <span class="m">3</span> &lt; dataset.mql
</pre></div>
</td></tr></table>

</details>
</details>
</details>
<details class="abstract"><summary>TF.importMQL()</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">TF</span><span class="o">.</span><span class="n">importMQL</span><span class="p">(</span><span class="n">mqlFile</span><span class="p">,</span> <span class="n">slotType</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">otext</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<details class="info" open="open"><summary>Description</summary><p>Converts an MQL database dump to a Text-Fabric dataset.</p>
</details>
<details class="hint"><summary>Destination directory</summary><p>It is recommended to call this <code>importMQL</code> on a TF instance called with</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">TF</span> <span class="o">=</span> <span class="n">Fabric</span><span class="p">(</span><span class="n">locations</span><span class="o">=</span><span class="n">targetDir</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Then the resulting features will be written in the targetDir.</p>
<p>In fact, the rules are exactly the same as for <code>TF.save()</code>.</p>
</details>
<details class="info"><summary>slotType</summary><p>You have to tell which object type in the MQL file acts as the slot type,
because TF cannot see that on its own.</p>
</details>
<details class="info"><summary>otext</summary><p>You can pass the information about sections and text formats as the parameter
<code>otext</code>. This info will end up in the <code>otext.tf</code> feature. Pass it as a
dictionary of keys and values, like so:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">otext</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;fmt:text-trans-plain&#39;</span><span class="p">:</span> <span class="s1">&#39;{glyphs}{trailer}&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sectionFeatures&#39;</span><span class="p">:</span> <span class="s1">&#39;book,chapter,verse&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

</details>
<details class="info"><summary>meta</summary><p>Likewise, you can add a dictionary of keys and values that will added to the
metadata of all features. Handy to add provenance data here:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;DLC&#39;</span><span class="p">,</span>
    <span class="n">datasetName</span><span class="o">=</span><span class="s1">&#39;Digital Language Corpus&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s2">&quot;That &#39;s me&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

</details>
</details>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Misc/" title="Miscellaneous" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Miscellaneous
              </span>
            </div>
          </a>
        
        
          <a href="../Lib/" title="Lib" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Lib
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.5e60981f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>