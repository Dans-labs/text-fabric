<!doctype html><html lang=en class=no-js> <head><link href=https://fonts.gstatic.com rel=preconnect crossorigin><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Text-Fabric is a Python3 package for Text plus Annotations. It provides a data model, a text file format, a binary format, an API, and apps for (ancient) text plus (linguistic) annotations."><link href=https://annotation.github.io/text-fabric/Server/Kernel/ rel=canonical><meta name=author content="Dirk Roorda"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../images/icon/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-dans-4.4.1"><title>Kernel - Text-Fabric</title><link rel=stylesheet href=../../assets/stylesheets/application.b34e347b.css><script src=../../assets/javascripts/modernizr.74668098.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Glegoo:300,400,400i,700|Ubuntu+Mono&display=swap"><style>.body-type,body,input{font-family:"Open Sans",sans-serif}.head-type,h1,h2,h3,h4,h5{font-family:"Glegoo",serif}.code-type,code,kbd,pre{font-family:"Ubuntu Mono",monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#text-fabric-kernel tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)" class="md-header-nav__button md-logo"> <img src=../../assets/images/DANS.gif height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://annotation.github.io/text-fabric/ title=Text-Fabric class="md-header-nav__button md-logo"> <img src=../../images/tf-small.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title head-type" data-md-component=title> <span class=md-header-nav__topic> Text-Fabric </span> <span class=md-header-nav__topic> Kernel </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/annotation/text-fabric/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class="md-tabs__link head-type"> Home </a> </li> <li class=md-tabs__item> <a href=../../About/Install/ title=About class="md-tabs__link head-type"> About </a> </li> <li class=md-tabs__item> <a href=../../Use/Use/ title=Use class="md-tabs__link head-type"> Use </a> </li> <li class=md-tabs__item> <a href=../../Api/App/ title=Api class="md-tabs__link head-type"> Api </a> </li> <li class=md-tabs__item> <a href=../../Writing/Arabic/ title=Writing class="md-tabs__link head-type"> Writing </a> </li> <li class=md-tabs__item> <a href=../../Model/Data-Model/ title=Model class="md-tabs__link head-type"> Model </a> </li> <li class=md-tabs__item> <a href=../../Create/Convert/ title=Create class="md-tabs__link head-type"> Create </a> </li> <li class=md-tabs__item> <a href=./ title=Server class="md-tabs__link md-tabs__link--active head-type"> Server </a> </li> <li class=md-tabs__item> <a href=../../Code/Overview/ title=Code class="md-tabs__link head-type"> Code </a> </li> <li class=md-tabs__item> <a href=../../Implementation/Apps/ title=Implementation class="md-tabs__link head-type"> Implementation </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title head-type md-nav__title--site" for=__drawer> <a href=https://annotation.github.io/text-fabric/ title=Text-Fabric class="md-nav__button md-logo"> <img src=../../images/tf-small.png width=48 height=48> </a> Text-Fabric </label> <div class=md-nav__source> <a href=https://github.com/annotation/text-fabric/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class="md-nav__link head-type"> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class="md-nav__link head-type" for=nav-2> About </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-2> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../About/Install/ title=Install class="md-nav__link head-type"> Install </a> </li> <li class=md-nav__item> <a href=../../About/Corpora/ title=Corpora class="md-nav__link head-type"> Corpora </a> </li> <li class=md-nav__item> <a href=../../About/Faq/ title=Faq class="md-nav__link head-type"> Faq </a> </li> <li class=md-nav__item> <a href=../../About/News/ title=News class="md-nav__link head-type"> News </a> </li> <li class=md-nav__item> <a href=../../About/Older/ title=Older class="md-nav__link head-type"> Older </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class="md-nav__link head-type" for=nav-3> Use </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-3> Use </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Use/Use/ title=Use class="md-nav__link head-type"> Use </a> </li> <li class=md-nav__item> <a href=../../Use/Browser/ title=Browser class="md-nav__link head-type"> Browser </a> </li> <li class=md-nav__item> <a href=../../Use/Search/ title=Search class="md-nav__link head-type"> Search </a> </li> <li class=md-nav__item> <a href=../../Use/UseX/ title=Advanced class="md-nav__link head-type"> Advanced </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class="md-nav__link head-type" for=nav-4> Api </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-4> Api </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Api/App/ title=Apps class="md-nav__link head-type"> Apps </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class="md-nav__link head-type" for=nav-4-2> Data flow </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class="md-nav__title head-type" for=nav-4-2> Data flow </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Api/Data/ title=Data class="md-nav__link head-type"> Data </a> </li> <li class=md-nav__item> <a href=../../Api/Repo/ title=Repo class="md-nav__link head-type"> Repo </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class="md-nav__link head-type" for=nav-4-3> Core </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class="md-nav__title head-type" for=nav-4-3> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Api/Fabric/ title=TF class="md-nav__link head-type"> TF </a> </li> <li class=md-nav__item> <a href=../../Api/Features/ title="E/F - (Edge-)Features" class="md-nav__link head-type"> E/F - (Edge-)Features </a> </li> <li class=md-nav__item> <a href=../../Api/Nodes/ title="N - Nodes" class="md-nav__link head-type"> N - Nodes </a> </li> <li class=md-nav__item> <a href=../../Api/Locality/ title="L - Locality" class="md-nav__link head-type"> L - Locality </a> </li> <li class=md-nav__item> <a href=../../Api/Text/ title="T - Text" class="md-nav__link head-type"> T - Text </a> </li> <li class=md-nav__item> <a href=../../Api/Search/ title="S - Search" class="md-nav__link head-type"> S - Search </a> </li> <li class=md-nav__item> <a href=../../Api/Computed/ title="C - Computed" class="md-nav__link head-type"> C - Computed </a> </li> <li class=md-nav__item> <a href=../../Api/Misc/ title=Miscellaneous class="md-nav__link head-type"> Miscellaneous </a> </li> <li class=md-nav__item> <a href=../../Api/Lib/ title=Lib class="md-nav__link head-type"> Lib </a> </li> <li class=md-nav__item> <a href=../../Api/Helpers/ title=Helpers class="md-nav__link head-type"> Helpers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class="md-nav__link head-type" for=nav-4-4> Compose </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class="md-nav__title head-type" for=nav-4-4> Compose </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Api/Compose/ title=Combining class="md-nav__link head-type"> Combining </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class="md-nav__link head-type" for=nav-5> Writing </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-5> Writing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Writing/Arabic/ title=Arabic class="md-nav__link head-type"> Arabic </a> </li> <li class=md-nav__item> <a href=../../Writing/Hebrew/ title=Hebrew class="md-nav__link head-type"> Hebrew </a> </li> <li class=md-nav__item> <a href=../../Writing/Syriac/ title=Syriac class="md-nav__link head-type"> Syriac </a> </li> <li class=md-nav__item> <a href=../../Writing/Transcription/ title=Transcription class="md-nav__link head-type"> Transcription </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class="md-nav__link head-type" for=nav-6> Model </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-6> Model </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Model/Data-Model/ title=Data class="md-nav__link head-type"> Data </a> </li> <li class=md-nav__item> <a href=../../Model/File-formats/ title=Format class="md-nav__link head-type"> Format </a> </li> <li class=md-nav__item> <a href=../../Model/Optimizations/ title=Tweaks class="md-nav__link head-type"> Tweaks </a> </li> <li class=md-nav__item> <a href=../../Model/Search/ title=Search class="md-nav__link head-type"> Search </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class="md-nav__link head-type" for=nav-7> Create </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-7> Create </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Create/Convert/ title=Convert class="md-nav__link head-type"> Convert </a> </li> <li class=md-nav__item> <a href=../../Create/CreateTF/ title=Pattern class="md-nav__link head-type"> Pattern </a> </li> <li class=md-nav__item> <a href=../../Create/ExampleText/ title="Example data" class="md-nav__link head-type"> Example data </a> </li> <li class=md-nav__item> <a href=../../Create/MQL/ title=MQL class="md-nav__link head-type"> MQL </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8 checked> <label class="md-nav__link head-type" for=nav-8> Server </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-8> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active head-type" for=__toc> Kernel </label> <a href=./ title=Kernel class="md-nav__link md-nav__link--active head-type"> Kernel </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#about title=About class="md-nav__link head-type"> About </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#start title=Start class="md-nav__link head-type"> Start </a> </li> <li class=md-nav__item> <a href=#connect title=Connect class="md-nav__link head-type"> Connect </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-api title="Kernel API" class="md-nav__link head-type"> Kernel API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Web/ title=Web class="md-nav__link head-type"> Web </a> </li> <li class=md-nav__item> <a href=../Common/ title=Common class="md-nav__link head-type"> Common </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class="md-nav__link head-type" for=nav-9> Code </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-9> Code </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Code/Overview/ title=Overview class="md-nav__link head-type"> Overview </a> </li> <li class=md-nav__item> <a href=../../Code/Tests/ title=Tests class="md-nav__link head-type"> Tests </a> </li> <li class=md-nav__item> <a href=../../Code/Stats/ title="Stats (overall)" class="md-nav__link head-type"> Stats (overall) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsToplevel/ title="Stats (TF-toplevel)" class="md-nav__link head-type"> Stats (TF-toplevel) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsCore/ title="Stats (TF-core)" class="md-nav__link head-type"> Stats (TF-core) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsSearch/ title="Stats (TF-search)" class="md-nav__link head-type"> Stats (TF-search) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsConvert/ title="Stats (TF-convert)" class="md-nav__link head-type"> Stats (TF-convert) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsCompose/ title="Stats (TF-compose)" class="md-nav__link head-type"> Stats (TF-compose) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsWriting/ title="Stats (TF-writing)" class="md-nav__link head-type"> Stats (TF-writing) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsServer/ title="Stats (TF-server)" class="md-nav__link head-type"> Stats (TF-server) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsApplib/ title="Stats (TF-app support)" class="md-nav__link head-type"> Stats (TF-app support) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsApps/ title="Stats (TF-apps)" class="md-nav__link head-type"> Stats (TF-apps) </a> </li> <li class=md-nav__item> <a href=../../Code/StatsTest/ title="Stats (Tests)" class="md-nav__link head-type"> Stats (Tests) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-10 type=checkbox id=nav-10> <label class="md-nav__link head-type" for=nav-10> Implementation </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-10> Implementation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Implementation/Apps/ title=Apps class="md-nav__link head-type"> Apps </a> </li> <li class=md-nav__item> <a href=../../Implementation/Setup/ title=Setup class="md-nav__link head-type"> Setup </a> </li> <li class=md-nav__item> <a href=../../Implementation/Data/ title=Data class="md-nav__link head-type"> Data </a> </li> <li class=md-nav__item> <a href=../../Implementation/Display/ title=Display class="md-nav__link head-type"> Display </a> </li> <li class=md-nav__item> <a href=../../Implementation/Highlight/ title=Highlight class="md-nav__link head-type"> Highlight </a> </li> <li class=md-nav__item> <a href=../../Implementation/Links/ title=Links class="md-nav__link head-type"> Links </a> </li> <li class=md-nav__item> <a href=../../Implementation/Search/ title=Search class="md-nav__link head-type"> Search </a> </li> <li class=md-nav__item> <a href=../../Implementation/Tables/ title=Tables class="md-nav__link head-type"> Tables </a> </li> <li class=md-nav__item> <a href=../../Implementation/Helpers/ title=Helpers class="md-nav__link head-type"> Helpers </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#about title=About class="md-nav__link head-type"> About </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#start title=Start class="md-nav__link head-type"> Start </a> </li> <li class=md-nav__item> <a href=#connect title=Connect class="md-nav__link head-type"> Connect </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-api title="Kernel API" class="md-nav__link head-type"> Kernel API </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/annotation/text-fabric/edit/master/docs/Server/Kernel.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=text-fabric-kernel>Text-Fabric kernel<a class=headerlink href=#text-fabric-kernel title="Permanent link">&para;</a></h1> <h2 id=about>About<a class=headerlink href=#about title="Permanent link">&para;</a></h2> <details class=abstract><summary>TF kernel</summary><p>Text-Fabric can be used as a service. The full API of Text-Fabric needs a lot of memory, which makes it unusably for rapid successions of loading and unloading, like when used in a web server context.</p> <p>However, you can start TF as a service process, after which many clients can connect to it, all looking at the same (read-only) data. We call this a <strong>TF kernel</strong>.</p> <p>The API that the TF kernel offers is limited, it is primarily template search that is offered. see <em>Kernel API</em> below.</p> <p>The code in <a href=https://github.com/annotation/text-fabric/blob/master/tf/server/kernel.py>kernel</a> explains how it works.</p> </details> <h3 id=start>Start<a class=headerlink href=#start title="Permanent link">&para;</a></h3> <details class=abstract><summary>Run</summary><p>You can run the TF kernel as follows:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>python3 -m tf.server.kernel ddd
</pre></div> </td></tr></table> <p>where <code>ddd</code> is one of the <a href=../../About/Corpora/ >supported apps</a></p> <details class=example><summary>Example</summary><p>See the <a href=https://github.com/annotation/text-fabric/blob/master/tf/server/start.py>start-up script</a> of the text-fabric browser.</p> </details> </details> <h3 id=connect>Connect<a class=headerlink href=#connect title="Permanent link">&para;</a></h3> <details class=abstract><summary>Connect</summary><p>The TF kernel can be connected by an other Python program as follows:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kn>from</span> <span class=nn>tf.server.kernel</span> <span class=kn>import</span> <span class=n>makeTfConnection</span>
<span class=n>TF</span> <span class=o>=</span> <span class=n>makeTfConnection</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
<span class=n>api</span> <span class=o>=</span> <span class=n>TF</span><span class=o>.</span><span class=n>connect</span><span class=p>()</span>
</pre></div> </td></tr></table> <p>After this, <code>api</code> can be used to obtain information from the TF kernel.</p> <details class=example><summary>Example</summary><p>See the <a href=https://github.com/annotation/text-fabric/blob/master/tf/server/web.py>web server</a> of the text-fabric browser.</p> </details> </details> <h2 id=kernel-api>Kernel API<a class=headerlink href=#kernel-api title="Permanent link">&para;</a></h2> <details class=abstract><summary>About</summary><p>The API of the TF kernel is created by the function <code>makeTfKernel</code> in the <a href=https://github.com/annotation/text-fabric/blob/master/tf/server/kernel.py>kernel</a> module of the server subpackage.</p> <p>It returns a class <code>TfKernel</code> with a number of exposed methods that can be called by other programs.</p> <p>For the machinery of interprocess communication we rely on the <a href=https://github.com/tomerfiliba/rpyc>rpyc</a> module. See especially the docs on <a href=https://rpyc.readthedocs.io/en/latest/docs/services.html#services>services</a>.</p> <details class=caution><summary>Shadow objects</summary><p>The way rpyc works in the case of data transmission has a pitfall. When a service returns a Python object to the client, it does not return the object itself, but only a shadow object so called <em>netref</em> objects. This strategy is called <a href=https://rpyc.readthedocs.io/en/latest/docs/theory.html#boxing>boxing</a>. To the client the shadow object looks like the real thing, but when the client needs to access members, they will be fetched on the fly.</p> <p>This is a performance problem when the service sends a big list or dict, and the client iterates over all its items. Each item will be fetched in a separate interprocess call, which causes an enormous overhead.</p> <p>Boxing only happens for mutable objects. And here lies the work-around:</p> <p>The service must send big chunks of data as immutable objects, such as tuples. They are sent within a single interprocess call, and fly swiftly through the connecting pipe. </p> </details> </details> <details class=abstract><summary>monitor()</summary><p>A utility function that spits out some information from the kernel to the outside work. At this moment it is only used for debugging, but later it can be useful to monitor the kernel or manage it while it remains running.</p> </details> <details class=abstract><summary>header()</summary><p>Calls the <code>header()</code> method of the app, which fetches all the stuff to create a header on the page with links to data and documentation of the data source.</p> </details> <details class=abstract><summary>provenance()</summary><p>Calls the <code>provenance()</code> method of the app, which fetches provenance metadata to be shown on exported pages.</p> </details> <details class=abstract><summary>setNames()</summary><p>Returns the names of sets that have been provided as custom sets to the kernel by means of the <a href><code>--sets=</code></a> command line argument with which the kernel was started.</p> <p>A web server kan use this informatiomn to write out provernance info.</p> </details> <details class=abstract><summary>css()</summary><p>Calls the <code>loadCSS()</code> method of the app, which delivers the CSS code to be inserted on the browser page.</p> </details> <details class=abstract><summary>condenseTypes()</summary><p>Fetches several things from the app and the generic TF api:</p> <ul> <li><code>condenseType</code>: the default node type that acts as a container for representing query results; for Bhsa it is <code>verse</code>, for Uruk it is <code>tablet</code>;</li> <li><code>exampleSection</code>: an example for the help text for this data source;</li> <li><code>levels</code>: information about the node types in this data source.</li> </ul> </details> <details class=abstract><summary>passage()</summary><p>Asks the kernel for passages (chunks of material corresponding to sections of level 1 (chapters).</p> <p>The material will be displayed as a sequence of plain representations of the sec2s, which can be expanded to pretty displays when the user chooses to do so.</p> <p>Parameters:</p> <details class=note><summary>sec0</summary><p>The level 0 section (book) in which the passage occurs</p> </details> <details class=note><summary>sec1</summary><p>The level 1 section (chapter) to fetch</p> </details> <details class=note><summary>sec2=None</summary><p>The level 2 section (verse) that should get focus</p> </details> <details class=note><summary>opened</summary><p>The set of items that are currently expanded into pretty display</p> </details> <details class=note><summary>features</summary><p>The features that should be displayed in pretty displays when expanding a plain representation of a sec2 into a pretty display</p> </details> <details class=note><summary>query</summary><p>The query whose results should be highlighted in the passage display.</p> </details> <details class=note><summary>getx</summary><p>If given, only a single sec2 (verse) will be fetched, but in pretty display. <code>getx</code> is the identifier (section label, verse number) of the item/</p> </details> <details class=note><summary>**options</summary><p>Additional, optional display options</p> </details> </details> <details class=abstract><summary>table()</summary><p>Fetches material corresponding to a list of sections or tuples of nodes.</p> <p>Parameters:</p> <details class=note><summary>kind</summary><p>Either <code>sections</code> or <code>tuples</code>: whether to find section material or tuple material;</p> </details> <details class=note><summary>task</summary><p>The list of things (sections or tuples) to retrieve the material for; Typically coming from the <em>section pad</em> / <em>node pad</em> in the browser.</p> </details> <details class=note><summary>opened=set()</summary><p>As in <code>passage()</code></p> </details> <details class=note><summary>features</summary><p>As in <code>passage()</code></p> </details> <details class=note><summary>getx</summary><p>As in <code>passage()</code></p> </details> <details class=note><summary>**options</summary><p>As in <code>passage()</code></p> </details> </details> <details class=abstract><summary>search()</summary><p>The work horse of this API. Executes a TF search template, retrieves formatted results, retrieves formatted results for additional nodes and sections.</p> <p>Parameters:</p> <details class=note><summary>query</summary><p>Search template to be executed. Typically coming from the <em>search pad</em> in the browser.</p> </details> <details class=note><summary>batch</summary><p>The number of table rows to show on one page in the browser.</p> </details> <details class=note><summary>position=1</summary><p>The position that is central in the browser. The navigation links take this position as the focus point, and enable the user to navigate to neighbouring results, in ever bigger strides.</p> </details> <details class=note><summary>opened=set()</summary><p>Which results have been expanded and need extended results. Normally, only the information to provide a <em>plain</em> representation of a result is being fetched, but for the opened ones information is gathered for pretty displays.</p> </details> <details class=note><summary>getx</summary><p>If given, only a single result will be fetched, but in pretty display. <code>getx</code> is the sequence number of the result.</p> </details> <details class=note><summary>condensed</summary><p>Whether or not the results should be <em>condensed</em>. Normally, results come as tuples of nodes, and each tuple is shown in a corresponding table row in plain or pretty display.</p> <p>But you can also <em>condense</em> results in container objects. All tuples will be inspected, and the nodes of each tuple will be gathered in containers, and these containers will be displayed in table rows. What is lost is the notion of an individual result, and what is gained is a better overview of where the parts of the results are.</p> </details> <details class=note><summary>condenseType</summary><p>When condensing results, you can choose the node type that acts as container.</p> <details class=caution><summary>Nodes get suppressed</summary><p>Nodes in result tuples that have a type that is bigger than the condenseType, will be skipped. E.g. if you have chapter nodes in your results, but you condense to verses, the chapter nodes will not show up. But if you condense to books, they will show up.</p> </details> </details> <details class=note><summary>withNodes=False</summary><p>Whether to include the node numbers into the formatted results.</p> </details> <details class=note><summary>linked=1</summary><p>Which column in the results should be hyperlinked to online representations closest to the objects in that column.</p> <p>Counting columns starts at 1.</p> </details> <details class=note><summary><strong>options</strong></summary><p>Additional keyword arguments are passed as options to the underlying API.</p> <p>For example, the Uruk API accepts <code>linenumbers</code> and <code>lineart</code>, which will ask to include line numbers and lineart in the formatted results.</p> </details> </details> <details class=abstract><summary>csvs()</summary><p>This is an other workhorse. It also asks for the things <code>search()</code> is asking for, but it does not want formatted results. It will get tabular data of result nodes, one for the <em>sections</em>, one for the <em>node tuples</em>, and one for the <em>search results</em>.</p> <p>For every node that occurs in this tabular data, features will be looked up. All loaded features will be looked up for those nodes. The result is a big table of nodes and feature values.</p> <p>The parameters are <em>query</em>, <em>tuples</em>, <em>sections</em>, <em>condensed</em>, <em>condenseType</em> and have the same meaning as in <code>search()</code> above.</p> </details> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../../Create/MQL/ title=MQL class="md-flex md-footer-nav__link md-footer-nav__link--prev head-type" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> MQL </span> </div> </a> <a href=../Web/ title=Web class="md-flex md-footer-nav__link md-footer-nav__link--next head-type" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Web </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-disclaimer> The content of this site is produced under responsibility of project <b>GitHub</b> and is subject to change. </div> <div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> customised by <a href=https://github.com/Dans-labs>Dans-labs</a> </div> </div> <div class=md-footer-dans> <div>DANS is an institute of KNAW and NWO</div> <div> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)"><img class=md-footer-dans__img src=../../assets/images/DANS.gif height=50></a> <a target=_blank href=https://www.knaw.nl/en><img src=../../assets/images/knaw.png height=50></a> <a target=_blank href=https://www.nwo.nl/en><img src=../../assets/images/nwo.png height=50></a> </div> <div><i>Driven by data</i></div> </div> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <ul class=md-footer-social> <li class=md-footer-social__li> <a href=http://eepurl.com/dvnr8D class="md-footer-social__link fa fa-envelope-square"> <span class=md-footer-social__desc>Newsletter</span> </a> </li> <li class=md-footer-social__li> <a href=https://twitter.com/DANSKNAW class="md-footer-social__link fa fa-twitter-square"> <span class=md-footer-social__desc>Twitter</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.youtube.com/user/DANSDataArchiving class="md-footer-social__link fa fa-youtube-square"> <span class=md-footer-social__desc>YouTube</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.linkedin.com/company/dans class="md-footer-social__link fa fa-linkedin-square"> <span class=md-footer-social__desc>LinkedIn</span> </a> </li> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.b61ecd22.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>